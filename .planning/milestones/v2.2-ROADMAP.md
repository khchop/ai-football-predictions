# Milestone v2.2: Match Page Rewrite

**Status:** ✅ SHIPPED 2026-02-04
**Phases:** 26-30
**Total Plans:** 17

## Overview

Complete rewrite of match detail pages from scratch with clean layout, zero duplicate content, and SEO/GEO optimization. This milestone establishes a context-driven architecture where data flows from a single source, then delivers a hero component that renders score exactly once, content sections for narratives and predictions, FAQ with schema markup, and finally assembles state-aware layouts while removing deprecated code.

## Phases

### Phase 26: Context Foundation

**Goal**: Establish data flow architecture where match data is fetched once and distributed via React Context
**Depends on**: Nothing (first phase of v2.2)
**Plans**: 2 plans

Plans:
- [x] 26-01-PLAN.md — Create MatchDataProvider component and useMatch hook
- [x] 26-02-PLAN.md — Integrate MatchDataProvider into match pages (matches/[id] and leagues/[slug]/[match])

**Details:**
- Created MatchDataProvider with memoized matchState derivation
- useMatch() hook provides type-safe context consumption
- Single source of truth established - no component fetches match data independently

### Phase 27: Hero Component

**Goal**: Create single authoritative score/VS display that renders match info exactly once
**Depends on**: Phase 26 (needs context for data)
**Plans**: 2 plans

Plans:
- [x] 27-01-PLAN.md — Create MatchHero component with useLiveMatchMinute polling hook and API route
- [x] 27-02-PLAN.md — Visual verification of hero component across all match states

**Details:**
- MatchHero displays score exactly once (no duplicates in header, H1, or elsewhere)
- Live matches show current score and match minute via 30s polling
- Visibility detection pauses polling when tab hidden
- LIVE badge has NO animation per user decision

### Phase 28: Content Sections

**Goal**: Deliver narrative content and predictions table that render correctly based on match state
**Depends on**: Phase 27 (hero provides visual anchor)
**Plans**: 3 plans

Plans:
- [x] 28-01-PLAN.md — Create MatchNarrative component with state-aware display
- [x] 28-02-PLAN.md — Create SortablePredictionsTable with sorting and color-coded points
- [x] 28-03-PLAN.md — Visual verification of content sections across all match states

**Details:**
- MatchNarrative shows "Match Preview" for upcoming/live, "Match Report" for finished
- SortablePredictionsTable displays all 35 models with clickable column headers
- Color-coded points: 4+ pts green, 3 pts yellow, 2 pts orange, <2 pts gray
- Icons (Trophy/Target/X) provide WCAG 1.4.1 accessibility compliance

### Phase 29: FAQ & SEO

**Goal**: Auto-generate FAQ from match data with proper Schema.org FAQPage markup
**Depends on**: Phase 28 (FAQ content derives from match data)
**Plans**: 5 plans

Plans:
- [x] 29-01-PLAN.md — Install Radix Accordion and create accordion.tsx UI component with animations
- [x] 29-02-PLAN.md — Extend FAQ generation to 5 state-specific questions
- [x] 29-03-PLAN.md — Consolidate FAQPage into MatchPageSchema @graph and update visual component
- [x] 29-04-PLAN.md — Visual verification of FAQ across match states and schema validation
- [x] 29-05-PLAN.md — Add missing eventStatus cases for postponed and cancelled

**Details:**
- FAQ section auto-generates 5 match-specific questions based on state
- AI-generated FAQ content using Together AI (Llama 4 Maverick)
- Single JSON-LD @graph contains SportsEvent + FAQPage schemas
- eventStatus correctly maps to scheduled/live/finished/postponed/cancelled

### Phase 30: Layout Assembly

**Goal**: Assemble state-aware layouts and remove all deprecated match page components
**Depends on**: Phase 29 (all components ready for assembly)
**Plans**: 5 plans

Plans:
- [x] 30-01-PLAN.md — Create MatchLayout component with state-aware section rendering
- [x] 30-02-PLAN.md — Create loading skeletons and error boundary
- [x] 30-03-PLAN.md — Integrate MatchLayout into match pages
- [x] 30-04-PLAN.md — Delete deprecated components
- [x] 30-05-PLAN.md — Visual verification of layout across all match states

**Details:**
- Match page renders as single scrollable page (no tabs on any device)
- Layout adapts to match state: Upcoming/Live/Finished show different content
- Sections follow order: Match Info -> Narrative -> Predictions -> FAQ
- 16 deprecated components removed (-1,673 lines)

---

## Milestone Summary

**Key Decisions:**
- CTX-001: Derive matchState in provider, not consumers (single source of truth)
- CTX-002: Use useMemo for both matchState and contextValue (prevent re-renders)
- HERO-001: LIVE badge has NO animation (animate-none override per user decision)
- HERO-002: Polling interval set to 30s (balances freshness with API quota)
- NAR-001: Use client-side fetch for narrative content (keeps component simple)
- PRED-001: Default sort by points (desc) for finished matches, alphabetical for upcoming
- SGEO-01: FAQPage added to existing @graph (single JSON-LD script contains all schema types)
- LAYOUT-001: Hide MatchNarrative during live matches (no preview during play)
- CLEAN-001: tab-content directory deleted entirely (no active imports)

**Issues Resolved:**
- Score duplication eliminated (was showing in header, H1, and content)
- Mobile tabs removed (user explicitly rejected; hides content from AI crawlers)
- Sticky header removed (user prefers natural scroll)
- H2H and league standings sections removed (clutter, not core value)

**Technical Debt Incurred:**
- PredictionsSummary component created but not integrated into MatchLayout
- Comment reference to old MatchHeader in match-data-provider.tsx docstring
- Missing 29-VERIFICATION.md file (work verified via summaries)

---

*For current project status, see .planning/ROADMAP.md*
