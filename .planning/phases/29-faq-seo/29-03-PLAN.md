---
phase: 29-faq-seo
plan: 03
type: execute
wave: 2
depends_on: ["29-01", "29-02"]
files_modified:
  - src/components/MatchPageSchema.tsx
  - src/components/match/match-faq.tsx
autonomous: true

must_haves:
  truths:
    - "Single JSON-LD @graph contains both SportsEvent and FAQPage schemas"
    - "FAQPage schema questions exactly match visible FAQ text"
    - "FAQ accordion allows multiple items open simultaneously"
    - "First FAQ item is expanded by default"
  artifacts:
    - path: "src/components/MatchPageSchema.tsx"
      provides: "Consolidated @graph with SportsEvent + FAQPage"
      contains: "@type.*FAQPage"
    - path: "src/components/match/match-faq.tsx"
      provides: "Accordion-based FAQ visual component"
      contains: "Accordion.*type=\"multiple\""
  key_links:
    - from: "src/components/match/match-faq.tsx"
      to: "generateMatchFAQs"
      via: "import"
      pattern: "import.*generateMatchFAQs.*from.*MatchFAQSchema"
    - from: "src/components/MatchPageSchema.tsx"
      to: "faqs"
      via: "props"
      pattern: "faqs.*FAQItem"
---

<objective>
Consolidate FAQPage into MatchPageSchema @graph and update match-faq.tsx to use Radix Accordion.

Purpose: Delivers SGEO-01 (single @graph), SGEO-02 (schema matches visible FAQ), and FAQ presentation per CONTEXT.md.
Output: Unified schema component and accessible accordion-based FAQ section.
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-faq-seo/29-CONTEXT.md
@.planning/phases/29-faq-seo/29-RESEARCH.md

# Prior plan outputs
@.planning/phases/29-faq-seo/29-01-SUMMARY.md
@.planning/phases/29-faq-seo/29-02-SUMMARY.md

# Files to modify
@src/components/MatchPageSchema.tsx
@src/components/match/match-faq.tsx
@src/components/ui/accordion.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add FAQPage to MatchPageSchema @graph</name>
  <files>src/components/MatchPageSchema.tsx</files>
  <action>
Modify MatchPageSchema to accept FAQ data and include FAQPage in the @graph.

1. **Update imports:**
```typescript
import type { FAQItem } from './match/MatchFAQSchema';
```

2. **Update interface:**
```typescript
interface MatchPageSchemaProps {
  match: Match;
  competition: {
    name: string;
    slug: string;
  };
  url: string;
  faqs: FAQItem[];  // NEW: Required prop
}
```

3. **Add FAQPage to @graph array** (after WebPage, before BreadcrumbList):
```typescript
// FAQPage - questions from match-specific FAQ
{
  '@type': 'FAQPage',
  '@id': `${url}#faq`,
  mainEntity: faqs.map(faq => ({
    '@type': 'Question',
    name: faq.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: faq.answer,
    },
  })),
},
```

4. **Update function signature:**
```typescript
export function MatchPageSchema({ match, competition, url, faqs }: MatchPageSchemaProps) {
```

This ensures FAQPage is part of the same @graph as SportsEvent, satisfying SGEO-01.
  </action>
  <verify>
    - `grep -q "FAQPage" src/components/MatchPageSchema.tsx && echo "Found"` returns "Found"
    - `grep -q "faqs.*FAQItem" src/components/MatchPageSchema.tsx && echo "Found"` returns "Found"
    - TypeScript compiles: `npx tsc --noEmit src/components/MatchPageSchema.tsx`
  </verify>
  <done>
    - MatchPageSchema accepts faqs: FAQItem[] prop
    - FAQPage schema added to @graph array
    - Single JSON-LD script contains both SportsEvent and FAQPage
  </done>
</task>

<task type="auto">
  <name>Task 2: Update match-faq.tsx to use Radix Accordion</name>
  <files>src/components/match/match-faq.tsx</files>
  <action>
Replace native `<details>` elements with Radix Accordion from Plan 01.

1. **Update imports:**
```typescript
import type { Match, Competition } from '@/lib/db/schema';
import { generateMatchFAQs } from './MatchFAQSchema';
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from '@/components/ui/accordion';
```

2. **Remove the MatchFAQSchema import and rendering** - schema is now in MatchPageSchema.

3. **Replace the FAQ rendering with Accordion:**
```tsx
export function MatchFAQ({ match, competition }: MatchFAQProps) {
  const faqs = generateMatchFAQs(match, competition);

  return (
    <section className="mt-16 pt-8 border-t border-border/50">
      <h2 className="text-2xl font-bold mb-6">Frequently Asked Questions</h2>

      <Accordion
        type="multiple"
        defaultValue={['item-0']}
        className="space-y-4"
      >
        {faqs.map((faq, i) => (
          <AccordionItem key={i} value={`item-${i}`}>
            <AccordionTrigger className="text-base md:text-lg text-left">
              {faq.question}
            </AccordionTrigger>
            <AccordionContent className="text-muted-foreground leading-relaxed text-sm md:text-base">
              {faq.answer}
            </AccordionContent>
          </AccordionItem>
        ))}
      </Accordion>
    </section>
  );
}
```

Key changes from native `<details>`:
- `type="multiple"` allows multiple items open (CONTEXT.md decision)
- `defaultValue={['item-0']}` opens first item by default (CONTEXT.md decision)
- Removes inline SVG chevron (now in AccordionTrigger)
- Removes the `<MatchFAQSchema>` component (schema moved to page level)

4. **Also export the faqs for page-level schema:**
Add a new export to get FAQs without rendering:
```typescript
export { generateMatchFAQs } from './MatchFAQSchema';
```
  </action>
  <verify>
    - `grep -q "type=\"multiple\"" src/components/match/match-faq.tsx && echo "Found"` returns "Found"
    - `grep -q "defaultValue" src/components/match/match-faq.tsx && echo "Found"` returns "Found"
    - `grep -qv "MatchFAQSchema" src/components/match/match-faq.tsx` confirms MatchFAQSchema not rendered
    - TypeScript compiles: `npx tsc --noEmit src/components/match/match-faq.tsx`
  </verify>
  <done>
    - MatchFAQ uses Radix Accordion instead of native details
    - type="multiple" allows multi-open per CONTEXT.md
    - defaultValue opens first item by default per CONTEXT.md
    - No separate FAQSchema script rendered (moved to MatchPageSchema)
  </done>
</task>

</tasks>

<verification>
- [ ] MatchPageSchema includes FAQPage in @graph
- [ ] MatchFAQ uses Radix Accordion with type="multiple"
- [ ] First item opens by default (defaultValue={['item-0']})
- [ ] No duplicate JSON-LD scripts for FAQ
- [ ] TypeScript compiles without errors
</verification>

<success_criteria>
- Single @graph contains SportsEvent + FAQPage (SGEO-01)
- Schema questions match visible FAQ exactly (SGEO-02) - same generateMatchFAQs source
- Accordion supports multi-open with first-item-open default
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/29-faq-seo/29-03-SUMMARY.md`
</output>
