# Plan 37-01: Create SyntheticProvider Class

## Frontmatter

```yaml
phase: 37
plan: 01
wave: 1
depends_on: []
files_modified:
  - src/lib/llm/providers/synthetic.ts (create)
autonomous: true
```

## Objective

Create the `SyntheticProvider` class extending `OpenAICompatibleProvider` with correct endpoint and authentication for Synthetic.new API.

## Context

- Synthetic.new uses OpenAI-compatible API at `https://api.synthetic.new/openai/v1/chat/completions`
- Authentication via `Authorization: Bearer ${SYNTHETIC_API_KEY}`
- Model IDs use `hf:org/model` format
- Existing `TogetherProvider` pattern to follow in `src/lib/llm/providers/together.ts`
- Reuse `OpenAICompatibleProvider` base class from `src/lib/llm/providers/base.ts`

## Tasks

<task id="1">
Create `src/lib/llm/providers/synthetic.ts` with:

1. Import `OpenAICompatibleProvider` from `./base`
2. Import `ModelPricing` and `ModelTier` types from `./together`
3. Define `SyntheticProvider` class:
   - `protected endpoint = 'https://api.synthetic.new/openai/v1/chat/completions'`
   - Constructor with: id, name, model, displayName, tier, pricing, isPremium
   - `getHeaders()` method using `SYNTHETIC_API_KEY` env var
   - Throw descriptive error if API key missing
</task>

## Implementation Details

```typescript
import { OpenAICompatibleProvider } from './base';
import { ModelPricing, ModelTier } from './together';

export class SyntheticProvider extends OpenAICompatibleProvider {
  protected endpoint = 'https://api.synthetic.new/openai/v1/chat/completions';

  public readonly tier: ModelTier;
  public readonly pricing: ModelPricing;

  constructor(
    public readonly id: string,
    public readonly name: string,
    public readonly model: string,
    public readonly displayName: string,
    tier: ModelTier,
    pricing: ModelPricing,
    public readonly isPremium: boolean = false
  ) {
    super();
    this.tier = tier;
    this.pricing = pricing;
  }

  protected getHeaders(): Record<string, string> {
    const apiKey = process.env.SYNTHETIC_API_KEY;
    if (!apiKey) {
      throw new Error('Synthetic API key is not configured (SYNTHETIC_API_KEY)');
    }
    return {
      Authorization: `Bearer ${apiKey}`,
      'Content-Type': 'application/json',
    };
  }

  estimateCost(inputTokens: number = 500, outputTokens: number = 50): number {
    const inputCost = (inputTokens / 1_000_000) * this.pricing.promptPer1M;
    const outputCost = (outputTokens / 1_000_000) * this.pricing.completionPer1M;
    return inputCost + outputCost;
  }
}
```

## Verification

- [ ] File created at `src/lib/llm/providers/synthetic.ts`
- [ ] Class extends `OpenAICompatibleProvider`
- [ ] Endpoint is `https://api.synthetic.new/openai/v1/chat/completions`
- [ ] `getHeaders()` uses `SYNTHETIC_API_KEY` environment variable
- [ ] Missing API key throws descriptive error
- [ ] TypeScript compiles without errors

## Must Haves

- PROV-01: SyntheticProvider class extends OpenAICompatibleProvider
- PROV-02: Provider uses `SYNTHETIC_API_KEY` environment variable
- PROV-03: Provider calls `https://api.synthetic.new/openai/v1/chat/completions`
- ERRH-02: Missing API key throws descriptive error
