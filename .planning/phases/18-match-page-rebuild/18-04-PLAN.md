---
phase: 18-match-page-rebuild
plan: 04
type: execute
wave: 2
depends_on: ["18-01", "18-02"]
files_modified:
  - src/components/match/match-faq.tsx
  - src/components/match/MatchFAQSchema.tsx
  - src/app/leagues/[slug]/[match]/page.tsx
autonomous: true

must_haves:
  truths:
    - "FAQ section appears at bottom of match page (supplementary)"
    - "FAQ questions vary by match state (upcoming/finished)"
    - "FAQPage JSON-LD schema renders in HTML for search engines"
    - "AI search engines can cite match content via structured data"
  artifacts:
    - path: "src/components/match/match-faq.tsx"
      provides: "Visual FAQ component with details/summary"
      exports: ["MatchFAQ"]
    - path: "src/components/match/MatchFAQSchema.tsx"
      provides: "FAQPage JSON-LD schema"
      exports: ["MatchFAQSchema"]
  key_links:
    - from: "src/app/leagues/[slug]/[match]/page.tsx"
      to: "src/components/match/match-faq.tsx"
      via: "import MatchFAQ"
      pattern: "MatchFAQ"
    - from: "src/components/match/match-faq.tsx"
      to: "src/components/match/MatchFAQSchema.tsx"
      via: "renders schema script"
      pattern: "MatchFAQSchema"
---

<objective>
Create FAQ component with JSON-LD schema for GEO (AI search engine optimization)

Purpose: Requirement MTCH-06 - AI search engines cite match page content in responses. User decision: FAQ at bottom for SEO value, not primary navigation. Auto-generated questions like "Who is predicted to win?", "What was the final score?"

Output: MatchFAQ visual component + MatchFAQSchema JSON-LD, integrated at bottom of match page
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-match-page-rebuild/18-CONTEXT.md
@.planning/phases/18-match-page-rebuild/18-RESEARCH.md
@src/components/match/MatchFAQSchema.tsx (existing, may need update)
@src/app/leagues/[slug]/[match]/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create or update MatchFAQSchema with state-aware questions</name>
  <files>src/components/match/MatchFAQSchema.tsx</files>
  <action>
Update the existing MatchFAQSchema component (or create if doesn't exist with this structure):

```tsx
import type { FAQPage, Question } from 'schema-dts'
import type { Match, Competition } from '@/lib/db/schema'

interface MatchFAQSchemaProps {
  match: Match
  competition: Competition
}

interface FAQItem {
  question: string
  answer: string
}

function generateMatchFAQs(match: Match, competition: Competition): FAQItem[] {
  const isUpcoming = match.status === 'scheduled'
  const isLive = match.status === 'live'
  const isFinished = match.status === 'finished'
  const kickoffDate = new Date(match.kickoffTime)

  const faqs: FAQItem[] = []

  // TL;DR question - always first (most important for GEO)
  if (isFinished && match.homeScore !== null && match.awayScore !== null) {
    faqs.push({
      question: `What was the final score of ${match.homeTeam} vs ${match.awayTeam}?`,
      answer: `${match.homeTeam} ${match.homeScore} - ${match.awayScore} ${match.awayTeam}. The match was played in the ${competition.name} on ${kickoffDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}.`,
    })
  } else if (isUpcoming || isLive) {
    faqs.push({
      question: `Who is predicted to win ${match.homeTeam} vs ${match.awayTeam}?`,
      answer: `AI models predict the outcome based on team form, historical matchups, and statistical analysis. View the predictions table on this page for individual model forecasts. Match kicks off ${kickoffDate.toLocaleString('en-US', { dateStyle: 'long', timeStyle: 'short' })}.`,
    })
  }

  // When/where questions
  faqs.push({
    question: `When is ${match.homeTeam} vs ${match.awayTeam}?`,
    answer: `The match ${isFinished ? 'was played' : 'kicks off'} on ${kickoffDate.toLocaleString('en-US', { dateStyle: 'full', timeStyle: 'short' })}${match.venue ? ` at ${match.venue}` : ''}.`,
  })

  faqs.push({
    question: `What competition is ${match.homeTeam} vs ${match.awayTeam} in?`,
    answer: `This match is part of the ${competition.name}${match.round ? ` (${match.round})` : ''}. Follow AI model predictions for this competition on kroam.xyz.`,
  })

  // Prediction methodology question
  faqs.push({
    question: 'How accurate are AI predictions for football matches?',
    answer: 'Our AI models use historical data, team form, head-to-head records, and statistical patterns to forecast match outcomes. Accuracy varies by model and competition. Predictions should be considered alongside other factors like team news, injuries, and match context.',
  })

  return faqs
}

export function MatchFAQSchema({ match, competition }: MatchFAQSchemaProps) {
  const faqs = generateMatchFAQs(match, competition)

  const schema: FAQPage = {
    '@type': 'FAQPage',
    mainEntity: faqs.map((faq): Question => ({
      '@type': 'Question',
      name: faq.question,
      acceptedAnswer: {
        '@type': 'Answer',
        text: faq.answer,
      },
    })),
  }

  // Note: @context added at page level with @graph, not here
  return (
    <script
      type="application/ld+json"
      dangerouslySetInnerHTML={{
        __html: JSON.stringify(schema),
      }}
    />
  )
}

// Export for use in visual component
export { generateMatchFAQs }
export type { FAQItem }
```

Key points:
- Reuses generateMatchFAQs for both schema and visual display
- State-aware questions (upcoming vs finished vs live)
- TL;DR question always first for GEO priority
- Uses existing schema-dts types for type safety
  </action>
  <verify>`grep "FAQPage\|generateMatchFAQs" src/components/match/MatchFAQSchema.tsx` shows FAQ schema generation</verify>
  <done>MatchFAQSchema generates state-aware FAQ JSON-LD</done>
</task>

<task type="auto">
  <name>Task 2: Create visual MatchFAQ component with details/summary</name>
  <files>src/components/match/match-faq.tsx</files>
  <action>
Create server component that displays FAQ visually using native HTML details/summary:

```tsx
import type { Match, Competition } from '@/lib/db/schema'
import { generateMatchFAQs, MatchFAQSchema } from './MatchFAQSchema'

interface MatchFAQProps {
  match: Match
  competition: Competition
}

export function MatchFAQ({ match, competition }: MatchFAQProps) {
  const faqs = generateMatchFAQs(match, competition)

  return (
    <section className="mt-16 pt-8 border-t border-border/50">
      <h2 className="text-2xl font-bold mb-6">Frequently Asked Questions</h2>

      {/* Visual FAQ display */}
      <div className="space-y-4">
        {faqs.map((faq, i) => (
          <details key={i} className="group border border-border/50 rounded-lg">
            <summary className="cursor-pointer font-medium text-base md:text-lg py-4 px-4 hover:bg-muted/30 transition-colors list-none flex items-center justify-between">
              <span>{faq.question}</span>
              <svg
                className="w-5 h-5 text-muted-foreground transition-transform group-open:rotate-180"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth={2}
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </summary>
            <div className="px-4 pb-4 pt-2 text-muted-foreground leading-relaxed text-sm md:text-base border-t border-border/30">
              {faq.answer}
            </div>
          </details>
        ))}
      </div>

      {/* JSON-LD schema for search engines */}
      <MatchFAQSchema match={match} competition={competition} />
    </section>
  )
}
```

Key points:
- Server component (no 'use client' needed)
- Native details/summary for accessibility and no JS requirement
- Chevron icon rotates on open (CSS transition)
- Clean visual styling with proper spacing
- Renders MatchFAQSchema for JSON-LD
- Placed at bottom per user decision (supplementary for SEO)
  </action>
  <verify>File exists at src/components/match/match-faq.tsx and exports MatchFAQ</verify>
  <done>MatchFAQ renders visual FAQ with accessible details/summary pattern</done>
</task>

<task type="auto">
  <name>Task 3: Integrate MatchFAQ at bottom of match page</name>
  <files>src/app/leagues/[slug]/[match]/page.tsx</files>
  <action>
Add MatchFAQ component at the bottom of the match page, after RelatedMatchesWidget:

1. Add import:
```tsx
import { MatchFAQ } from '@/components/match/match-faq'
```

2. In the desktop layout section (hidden md:block), add after RelatedMatchesWidget:
```tsx
{/* Related Matches - SEO Internal Linking */}
<RelatedMatchesWidget matchId={matchData.id} competitionSlug={competitionSlug} />

{/* FAQ Section - GEO Optimization (supplementary, at bottom) */}
<MatchFAQ match={matchData} competition={competition} />
```

3. Also add to mobile layout if appropriate, or keep desktop-only since it's supplementary for SEO.

4. Verify the FAQ section:
   - Appears at absolute bottom of page (after all primary content)
   - Does not interrupt the main user flow
   - JSON-LD renders in page source

Note: The existing MatchFAQSchema import (if used elsewhere) may need adjustment to avoid duplicate schema. Check if MatchPageSchema already includes FAQ - if so, consolidate.
  </action>
  <verify>
1. `grep "MatchFAQ" src/app/leagues/[slug]/[match]/page.tsx` shows import and usage
2. Build passes: `npm run build`
3. View page source shows FAQPage JSON-LD schema
  </verify>
  <done>MatchFAQ integrated at bottom of match page, JSON-LD renders in HTML</done>
</task>

</tasks>

<verification>
1. FAQ content verification:
   - Load upcoming match page: "Who is predicted to win?" question appears
   - Load finished match page: "What was the final score?" question appears

2. Schema verification:
   - View page source (Ctrl+U)
   - Search for "FAQPage"
   - Verify JSON-LD structure is valid

3. Schema validator:
   ```bash
   # Test with Google's Rich Results Test
   # https://search.google.com/test/rich-results
   ```

4. Visual placement:
   - FAQ section at bottom (after Related Matches)
   - Does not interrupt predictions or primary content

5. Accessibility:
   - details/summary works without JavaScript
   - Chevron provides visual affordance
</verification>

<success_criteria>
- FAQ section renders at bottom of match page (supplementary position)
- Questions vary by match state (upcoming shows "predicted to win", finished shows "final score")
- FAQPage JSON-LD schema present in page source
- Native details/summary works without JavaScript
- Visual styling matches design system (borders, spacing, transitions)
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/18-match-page-rebuild/18-04-SUMMARY.md`
</output>
