---
phase: 17-design-system-foundation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/globals.css
  - src/lib/design-tokens.ts
autonomous: true

must_haves:
  truths:
    - "User experiences readable typography at all breakpoints"
    - "Spacing is consistent across UI components (4px/8px rhythm)"
    - "Numbers in tables align vertically (tabular figures)"
    - "Typography scale follows 1.2 ratio from mobile base"
  artifacts:
    - path: "src/app/globals.css"
      provides: "Typography and spacing tokens"
      contains: "--text-base"
    - path: "src/lib/design-tokens.ts"
      provides: "TypeScript token exports for autocomplete"
      exports: ["spacing", "typography"]
  key_links:
    - from: "src/lib/design-tokens.ts"
      to: "src/app/globals.css"
      via: "mirrored token values"
      pattern: "spacing|typography"
---

<objective>
Define typography scale (1.2 ratio with system fonts) and spacing system (4px/8px rhythm) as design tokens.

Purpose: Establish consistent type hierarchy and spacing rhythm that all components will use. This enables readable content at all breakpoints and visual consistency across the design system.

Output: Typography and spacing tokens in globals.css, utility classes for tabular/proportional figures, and TypeScript exports for developer ergonomics.
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-design-system-foundation/17-CONTEXT.md
@.planning/phases/17-design-system-foundation/17-RESEARCH.md
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add typography scale tokens to globals.css</name>
  <files>src/app/globals.css</files>
  <action>
Add typography tokens to the @theme block in globals.css:

1. System font stack (user decision: system fonts for fast loading, native feel):
   ```css
   --font-sans: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
   ```
   Note: Keep existing --font-geist-sans and --font-geist-mono mappings for backwards compatibility, but add system-ui as primary.

2. Type scale using 1.2 ratio (Minor Third), 16px base (user decision: browser default, accessible):
   ```css
   --text-xs: 0.694rem;    /* 11.11px - 16 / 1.2^2 */
   --text-sm: 0.833rem;    /* 13.33px - 16 / 1.2 */
   --text-base: 1rem;      /* 16px - base */
   --text-lg: 1.2rem;      /* 19.2px - 16 * 1.2 */
   --text-xl: 1.44rem;     /* 23.04px - 16 * 1.2^2 */
   --text-2xl: 1.728rem;   /* 27.65px - 16 * 1.2^3 */
   --text-3xl: 2.074rem;   /* 33.18px - 16 * 1.2^4 */
   --text-4xl: 2.488rem;   /* 39.81px - 16 * 1.2^5 */
   ```

3. Line heights for readability:
   ```css
   --leading-tight: 1.25;
   --leading-normal: 1.5;
   --leading-relaxed: 1.75;
   ```

4. Font weights:
   ```css
   --font-normal: 400;
   --font-medium: 500;
   --font-semibold: 600;
   --font-bold: 700;
   ```

5. Update @layer base body rule to use system font:
   ```css
   body {
     font-family: var(--font-sans);
     font-size: var(--text-base);
     line-height: var(--leading-normal);
   }
   ```

Note: These tokens extend globals.css - do NOT replace the color tokens from Plan 01 (they run in parallel, Wave 1).
  </action>
  <verify>
Typography tokens exist: `grep -c "text-base\|text-lg\|text-xl" src/app/globals.css` shows matches.
  </verify>
  <done>Typography scale tokens (1.2 ratio) added to globals.css @theme block with system font stack.</done>
</task>

<task type="auto">
  <name>Task 2: Add spacing tokens and utility classes</name>
  <files>src/app/globals.css</files>
  <action>
Add spacing tokens and utility classes to globals.css:

1. Spacing tokens in @theme block (4px/8px rhythm per user decision):
   ```css
   --spacing-0: 0;
   --spacing-0.5: 0.125rem;  /* 2px - half unit */
   --spacing-1: 0.25rem;     /* 4px - base unit */
   --spacing-1.5: 0.375rem;  /* 6px */
   --spacing-2: 0.5rem;      /* 8px - major unit */
   --spacing-2.5: 0.625rem;  /* 10px */
   --spacing-3: 0.75rem;     /* 12px */
   --spacing-4: 1rem;        /* 16px */
   --spacing-5: 1.25rem;     /* 20px */
   --spacing-6: 1.5rem;      /* 24px */
   --spacing-8: 2rem;        /* 32px */
   --spacing-10: 2.5rem;     /* 40px */
   --spacing-12: 3rem;       /* 48px */
   --spacing-16: 4rem;       /* 64px */
   --spacing-20: 5rem;       /* 80px */
   --spacing-24: 6rem;       /* 96px */
   ```

2. Add utility classes in @layer utilities:
   ```css
   /* Numeric figure styling */
   .tabular-nums {
     font-variant-numeric: tabular-nums;
   }
   .proportional-nums {
     font-variant-numeric: proportional-nums;
   }

   /* Slashed zero for data clarity */
   .slashed-zero {
     font-variant-numeric: slashed-zero;
   }

   /* Common number styling combo for tables */
   .table-nums {
     font-variant-numeric: tabular-nums slashed-zero;
   }
   ```

3. Add base styles for text rhythm in @layer base:
   ```css
   /* Vertical rhythm for prose content */
   .prose p,
   .prose ul,
   .prose ol {
     margin-bottom: var(--spacing-4);
   }

   .prose h1,
   .prose h2,
   .prose h3 {
     margin-bottom: var(--spacing-2);
     margin-top: var(--spacing-8);
   }
   ```

Note: Do NOT remove existing utility classes (gradient-primary, glass, etc.) - add these as new utilities.
  </action>
  <verify>
Spacing tokens exist: `grep -c "spacing-4\|spacing-8" src/app/globals.css` shows matches.
Tabular nums utility exists: `grep "tabular-nums" src/app/globals.css` returns match.
  </verify>
  <done>Spacing tokens (4px/8px rhythm) and numeric figure utilities added to globals.css.</done>
</task>

<task type="auto">
  <name>Task 3: Create TypeScript design token exports</name>
  <files>src/lib/design-tokens.ts</files>
  <action>
Create src/lib/design-tokens.ts for TypeScript autocomplete and documentation:

```typescript
/**
 * Design token exports for TypeScript consumers.
 * These mirror the CSS custom properties in globals.css.
 *
 * Usage:
 * - Import for type-safe token references
 * - Use CSS variables (var(--spacing-4)) in styles
 * - Use these exports for programmatic access
 */

export const spacing = {
  0: '0',
  0.5: '0.125rem',
  1: '0.25rem',
  1.5: '0.375rem',
  2: '0.5rem',
  2.5: '0.625rem',
  3: '0.75rem',
  4: '1rem',
  5: '1.25rem',
  6: '1.5rem',
  8: '2rem',
  10: '2.5rem',
  12: '3rem',
  16: '4rem',
  20: '5rem',
  24: '6rem',
} as const

export const typography = {
  fontSize: {
    xs: '0.694rem',
    sm: '0.833rem',
    base: '1rem',
    lg: '1.2rem',
    xl: '1.44rem',
    '2xl': '1.728rem',
    '3xl': '2.074rem',
    '4xl': '2.488rem',
  },
  lineHeight: {
    tight: '1.25',
    normal: '1.5',
    relaxed: '1.75',
  },
  fontWeight: {
    normal: '400',
    medium: '500',
    semibold: '600',
    bold: '700',
  },
} as const

export const colors = {
  // Semantic match state colors (CSS variable names)
  win: 'var(--color-win)',
  draw: 'var(--color-draw)',
  loss: 'var(--color-loss)',

  // Accuracy gradient
  accuracyLow: 'var(--color-accuracy-low)',
  accuracyMid: 'var(--color-accuracy-mid)',
  accuracyHigh: 'var(--color-accuracy-high)',
} as const

export type SpacingKey = keyof typeof spacing
export type FontSizeKey = keyof typeof typography.fontSize
export type LineHeightKey = keyof typeof typography.lineHeight
export type FontWeightKey = keyof typeof typography.fontWeight
```

This file provides:
- Developer autocomplete for token values
- Type safety for token keys
- Documentation of the design system
- Programmatic access when CSS variables aren't suitable
  </action>
  <verify>
File exists: `test -f src/lib/design-tokens.ts && echo "exists"`.
Exports correct: `grep "export const spacing" src/lib/design-tokens.ts` returns match.
  </verify>
  <done>TypeScript design token exports created for developer ergonomics and type safety.</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without TypeScript or CSS errors
2. Typography tokens visible: `grep "text-xl\|text-2xl" src/app/globals.css`
3. Spacing tokens visible: `grep "spacing-8\|spacing-12" src/app/globals.css`
4. TypeScript imports work: Can import { spacing } from '@/lib/design-tokens'
5. Tabular nums utility available: `grep "tabular-nums" src/app/globals.css`
</verification>

<success_criteria>
1. Typography scale (1.2 ratio) defined as CSS custom properties
2. Spacing system (4px/8px rhythm) defined as CSS custom properties
3. Numeric figure utilities (tabular-nums, proportional-nums) available
4. TypeScript token exports provide autocomplete for developers
5. Existing utility classes preserved (gradient-*, glass, glow-*, etc.)
</success_criteria>

<output>
After completion, create `.planning/phases/17-design-system-foundation/17-02-SUMMARY.md`
</output>
