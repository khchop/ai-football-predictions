---
phase: 24-match-page-cleanup
plan: 02
type: execute
wave: 2
depends_on: ["24-01"]
files_modified:
  - src/app/leagues/[slug]/[match]/page.tsx
  - src/components/match/MatchStats.tsx
autonomous: true

must_haves:
  truths:
    - "Content appears in order: Score, Scorers/Goals, Odds, Pre-match, Prediction, Post-match, Predictions Table, FAQ"
    - "H2H and league standings sections are not visible on any match page"
    - "Sections with no data are completely hidden (no 'unavailable' placeholders)"
  artifacts:
    - path: "src/app/leagues/[slug]/[match]/page.tsx"
      provides: "Unified layout with correct section order and conditional rendering"
    - path: "src/components/match/MatchStats.tsx"
      provides: "Stats component without H2H or standings"
  key_links:
    - from: "page.tsx"
      to: "MatchEvents"
      via: "conditional render on events.length"
      pattern: "matchEvents\\.length > 0"
    - from: "page.tsx"
      to: "MatchContentSection"
      via: "render in correct position"
      pattern: "MatchContentSection"
---

<objective>
Unify match page layout order and hide unused/empty sections.

Purpose: Deliver consistent content experience by establishing a clear visual hierarchy (Score -> Scorers -> Odds -> Analysis -> Predictions -> FAQ) and hiding sections that have no data or are not useful (H2H, standings). Users should never see "no data available" placeholders.

Output: Match page with correct section ordering and intelligent section visibility based on data availability.
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-match-page-cleanup/24-RESEARCH.md
@.planning/phases/24-match-page-cleanup/24-01-SUMMARY.md

@src/app/leagues/[slug]/[match]/page.tsx
@src/components/match/MatchStats.tsx
@src/components/match/match-odds.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove H2H and standings from MatchStats</name>
  <files>src/components/match/MatchStats.tsx</files>
  <action>
    Refactor MatchStats to remove H2H and League Context sections completely:

    1. Remove the "League Context" Card entirely (the one with Trophy icon showing standings and form)
       - Delete the entire Card component that contains "League Context" heading
       - This includes the isCupMatch check and both team standing displays

    2. Remove the "Head-to-Head" Card entirely (the one with History icon)
       - Delete the entire Card component that contains H2H data
       - This includes the h2hResults mapping and h2hTotal display

    3. Keep ONLY the "Predictions" Card (with TrendingUp icon showing homeWinPct, drawPct, awayWinPct, and odds)

    4. Keep the "Match Stats" Card (with BarChart3 icon showing possession, xG, shots, etc.) - this only shows for finished matches with roundup stats

    5. Update the grid layout: Since we removed 2 cards, change the grid from:
       `grid grid-cols-1 md:grid-cols-3` (or the dynamic one)
       to: `grid grid-cols-1 md:grid-cols-2 gap-6`
       (Predictions card + optional Match Stats card)

    6. Remove unused imports: `Trophy`, `History`, `H2HMatch` type
    7. Remove unused props and variables: `homeStanding`, `awayStanding`, `h2hResults`, `isCupMatch`
    8. Update the component interface to remove `homeStanding` and `awayStanding` props

    CRITICAL: The component should return null if there's no analysis data AND no roundup stats (nothing to show).
  </action>
  <verify>
    - `grep -c "League Context" src/components/match/MatchStats.tsx` returns 0
    - `grep -c "Head-to-Head" src/components/match/MatchStats.tsx` returns 0
    - `grep -c "H2HMatch" src/components/match/MatchStats.tsx` returns 0
    - `grep -c "homeStanding" src/components/match/MatchStats.tsx` returns 0
    - `npx tsc --noEmit` succeeds
  </verify>
  <done>MatchStats shows only Predictions and Match Stats cards, no H2H or standings</done>
</task>

<task type="auto">
  <name>Task 2: Update page to match required layout order and fix MatchStats props</name>
  <files>src/app/leagues/[slug]/[match]/page.tsx</files>
  <action>
    Reorder sections in page.tsx to match required order and update MatchStats usage:

    Required order: Score -> Scorers/Goals -> Odds -> Pre-match -> Prediction -> Post-match -> Predictions Table -> FAQ

    1. Update MatchStats component call to remove homeStanding and awayStanding props:
       ```tsx
       <MatchStats
         analysis={analysis || null}
         homeTeam={matchData.homeTeam}
         awayTeam={matchData.awayTeam}
         roundupStats={roundup?.stats ? JSON.parse(roundup.stats) as RoundupStats : null}
         isFinished={isFinished}
       />
       ```

    2. Reorder the sections within the `<div className="space-y-8">` block to be:
       a. MatchPageHeader (Score) - already at top, keep it
       b. Match Events card (Scorers/Goals) - the conditional matchEvents block, move if needed
       c. MatchStats (contains Odds/Predictions analysis) - move after events
       d. MatchContentSection (Pre-match, Prediction, Post-match narratives) - already handles state-based visibility
       e. PredictionTable card (Predictions Table) - the "AI Model Predictions" section
       f. Explore More card - keep as navigation aid
       g. RelatedMatchesWidget - keep for SEO
       h. MatchFAQ (FAQ) - keep at end

    3. Remove the teamStandings fetch and related code since standings are no longer used:
       - Remove `getStandingsForTeams` from the Promise.all
       - Remove `homeStanding` and `awayStanding` variable declarations
       - Update the Promise.all destructuring

    4. Clean up any unused imports (getStandingsForTeams if not used elsewhere)

    Note: MatchContentSection already returns null when no content, and handles pre-match/post-match visibility based on match status. Match Events already has conditional rendering. These satisfy FILT-03 and FILT-04.
  </action>
  <verify>
    - `grep -c "getStandingsForTeams" src/app/leagues/[slug]/[match]/page.tsx` returns 0
    - `grep -c "homeStanding" src/app/leagues/[slug]/[match]/page.tsx` returns 0
    - `npm run build` succeeds
  </verify>
  <done>Page sections in correct order, standings fetch removed, MatchStats called with correct props</done>
</task>

<task type="auto">
  <name>Task 3: Ensure empty sections are hidden without placeholders</name>
  <files>src/components/match/MatchStats.tsx</files>
  <action>
    Verify and fix MatchStats to hide completely when no meaningful data exists:

    1. At the top of the component, add an early return if there's nothing to show:
       ```tsx
       // Hide entire component if no predictions and no match stats
       const hasPredictions = analysis && (analysis.homeWinPct || analysis.oddsHome);
       const hasMatchStats = isFinished && roundupStats && (
         roundupStats.possession !== undefined ||
         roundupStats.xG !== undefined ||
         roundupStats.shots !== undefined ||
         roundupStats.corners !== undefined
       );

       if (!hasPredictions && !hasMatchStats) {
         return null;
       }
       ```

    2. For the Predictions card, wrap it in a conditional:
       ```tsx
       {hasPredictions && (
         <Card>...</Card>
       )}
       ```

    3. The Match Stats card already has `{hasRoundupStats && (...)}` conditional - verify it's correct

    4. Remove any placeholder text like "No data", "N/A", "Not available", "unavailable" from the component

    This ensures FILT-03 (hide empty sections) and FILT-04 (no placeholder messages) are satisfied.
  </action>
  <verify>
    - `grep -ci "no data\|unavailable\|not available\|n/a" src/components/match/MatchStats.tsx` returns 0 (case insensitive)
    - Component returns null when no analysis and no roundup stats
    - `npm run build` succeeds
  </verify>
  <done>MatchStats hides completely when no data, no placeholder messages shown</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build` succeeds
2. `npm run dev` and visit match pages in different states:
   - Scheduled match: Shows Score, Odds (if available), Pre-match content
   - Finished match: Shows Score, Scorers/Goals, Odds, Prediction, Post-match, Predictions Table, FAQ
3. No H2H section visible on any match page
4. No league standings section visible on any match page
5. No "no data" or "unavailable" placeholder text anywhere
6. Empty sections are completely hidden (not just collapsed or showing empty state)
</verification>

<success_criteria>
- Layout order matches spec: Score -> Scorers/Goals -> Odds -> Pre-match -> Prediction -> Post-match -> Predictions Table -> FAQ
- H2H section completely removed (FILT-01)
- League standings section completely removed (FILT-02)
- Empty sections hidden without placeholders (FILT-03, FILT-04)
- Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/24-match-page-cleanup/24-02-SUMMARY.md`
</output>
