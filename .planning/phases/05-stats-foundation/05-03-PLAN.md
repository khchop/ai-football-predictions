---
phase: 05-stats-foundation
plan: 03
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/app/models/[id]/page.tsx
autonomous: true

must_haves:
  truths:
    - "Model page metadata shows tendency accuracy, not exact score accuracy"
    - "OG image URL uses correctTendencies / scoredPredictions for accuracy"
    - "Accuracy in metadata matches accuracy in hero section"
  artifacts:
    - path: "src/app/models/[id]/page.tsx"
      provides: "Model detail page with correct metadata accuracy"
      contains: "correctTendencies"
  key_links:
    - from: "src/app/models/[id]/page.tsx generateMetadata"
      to: "predictionStats.correctTendencies"
      via: "accuracy calculation"
      pattern: "correctTendencies.*scoredPredictions"
---

<objective>
Fix the model detail page to show tendency accuracy in metadata instead of exact score accuracy.

Purpose: The OG image and metadata currently show exact score accuracy (typically 5-10%) instead of tendency accuracy (typically 80-90%). This creates confusion when social shares show different numbers than the page displays.

Output: Updated `src/app/models/[id]/page.tsx` where metadata accuracy uses correctTendencies/scoredPredictions.
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-stats-foundation/05-RESEARCH.md
@.planning/phases/05-stats-foundation/05-01-SUMMARY.md

# File to modify
@src/app/models/[id]/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix metadata accuracy calculation</name>
  <files>src/app/models/[id]/page.tsx</files>
  <action>
In `src/app/models/[id]/page.tsx`, find the `generateMetadata` function (around line 34).

Current WRONG code (lines 51-53):
```typescript
// Calculate accuracy from stats (exactScores / scoredPredictions * 100)
const accuracy = predictionStats?.scoredPredictions && predictionStats.scoredPredictions > 0
  ? Math.round((predictionStats.exactScores / predictionStats.scoredPredictions) * 100)
  : 0;
```

Problem: Uses `exactScores` (exact score predictions, typically 5-10%) instead of `correctTendencies` (tendency accuracy, typically 80-90%).

Fix:
```typescript
// Calculate tendency accuracy from stats (correctTendencies / scoredPredictions * 100)
// This matches the hero section's "Accuracy" display
const accuracy = predictionStats?.scoredPredictions && predictionStats.scoredPredictions > 0
  ? Math.round((predictionStats.correctTendencies / predictionStats.scoredPredictions) * 100)
  : 0;
```

This ensures:
1. OG image shows ~85% accuracy (tendency) not ~8% (exact scores)
2. Twitter card shows same number as page hero section
3. Social shares display meaningful accuracy metric
  </action>
  <verify>
Verify fix: `grep -A2 "Calculate.*accuracy" src/app/models/[id]/page.tsx | grep -q "correctTendencies" && echo "Fixed" || echo "Still wrong"`
Ensure exactScores is NOT used for main accuracy: `grep "accuracy.*exactScores" src/app/models/[id]/page.tsx | grep -v "//" | wc -l` should be 0
  </verify>
  <done>Metadata accuracy uses correctTendencies / scoredPredictions, matching hero section</done>
</task>

<task type="auto">
  <name>Task 2: Update metadata description for clarity</name>
  <files>src/app/models/[id]/page.tsx</files>
  <action>
Update the openGraph description (around line 71) to be more specific about what the accuracy metric represents:

Current:
```typescript
description: `${accuracy}% accurate football predictions - Rank #${rank}`,
```

Change to:
```typescript
description: `${accuracy}% tendency accuracy in football predictions - Rank #${rank}`,
```

Also update the Twitter description (around line 86):
```typescript
description: `${accuracy}% tendency accuracy in football predictions`,
```

This makes it explicit that we're showing tendency accuracy (predicting correct winner/draw), not exact score accuracy.
  </action>
  <verify>`grep -q "tendency accuracy" src/app/models/[id]/page.tsx && echo "Description updated"`</verify>
  <done>Metadata descriptions explicitly label accuracy as "tendency accuracy"</done>
</task>

</tasks>

<verification>
1. Metadata accuracy uses correctTendencies: `grep "correctTendencies" src/app/models/[id]/page.tsx | grep accuracy`
2. No exactScores in accuracy calculation for metadata: `grep -B2 -A2 "const accuracy" src/app/models/[id]/page.tsx | grep -v exactScores`
3. Description mentions "tendency accuracy": `grep "tendency accuracy" src/app/models/[id]/page.tsx`
4. TypeScript compiles: `npx tsc --noEmit src/app/models/[id]/page.tsx`
</verification>

<success_criteria>
- generateMetadata uses correctTendencies for accuracy calculation
- OG image URL parameters use tendency accuracy (~85%) not exact (~8%)
- Social share previews show same accuracy as page hero section
- User sees consistent accuracy numbers everywhere for same model
</success_criteria>

<output>
After completion, create `.planning/phases/05-stats-foundation/05-03-SUMMARY.md`
</output>
