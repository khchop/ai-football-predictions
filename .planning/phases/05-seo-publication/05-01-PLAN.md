---
phase: 05-seo-publication
plan: '01'
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/seo/constants.ts
  - src/lib/seo/metadata.ts
  - src/lib/seo/schema/sports-event.ts
  - src/lib/seo/schema/article.ts
  - src/lib/seo/schema/graph.ts
  - src/lib/seo/og/templates.ts
  - src/lib/seo/types.ts
autonomous: true
user_setup: []
---

<objective>
Create SEO utility layer with metadata builders, JSON-LD schema builders, and OG image templates.

Purpose: Establish reusable SEO infrastructure that all subsequent plans will depend on. Prevents code duplication and ensures consistent metadata/schema across all pages.

Output: 7 utility files (constants, types, metadata builders, schema builders, OG templates)
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/05-seo-publication/05-CONTEXT.md
@.planning/phases/05-seo-publication/05-RESEARCH.md
@src/lib/db/schema.ts
</context>

<tasks>

<task type="auto">
  <name>Create SEO constants and types</name>
  <files>src/lib/seo/constants.ts, src/lib/seo/types.ts</files>
  <action>
Create src/lib/seo/constants.ts:
- Export BASE_URL from environment or throw if missing
- Define MatchStatus enum ('upcoming', 'live', 'finished')
- Define OG_IMAGE_SIZE = { width: 1200, height: 630 }
- Export SITE_NAME = 'BettingSoccer'
- Export DEFAULT_OG_TEMPLATE = 'upcoming'

Create src/lib/seo/types.ts:
- Export MatchSeoData interface with all fields needed for metadata/schema (id, homeTeam, awayTeam, homeScore, awayScore, status, competition, startDate, venue, homeTeamLogo, awayTeamLogo, round, predictionsCount, topModelName, topModelAccuracy)
- Export MetadataInput type for metadata builder
- Export SchemaInput type for schema builders
</action>
  <verify>
ls -la src/lib/seo/constants.ts src/lib/seo/types.ts
cat src/lib/seo/constants.ts | grep "BASE_URL\|MatchStatus"
cat src/lib/seo/types.ts | grep "MatchSeoData"</verify>
  <done>
SEO constants and types exported from src/lib/seo/</done>
</task>

<task type="auto">
  <name>Create metadata builders for dynamic titles and descriptions</name>
  <files>src/lib/seo/metadata.ts</files>
  <action>
Create src/lib/seo/metadata.ts following Pattern 1 from research:
- createTitle(match: MatchSeoData): string - formats as "{Home} {score} {Away} | Match Analysis & Predictions" (vs for upcoming)
- createDescription(match: MatchSeoData): string - returns state-specific description:
  - Upcoming: "Get AI predictions for {Home} vs {Away}. See which models forecast the winner before kickoff on {Date}."
  - Live: "Follow {Home} vs {Away} live. Track AI predictions in real-time and see how models perform as the action unfolds."
  - Finished: "Comprehensive coverage of {Home} vs {Away} in {Competition}. Match stats, AI predictions from {N} models, and model leaderboard rankings."
- buildMatchMetadata(match: MatchSeoData): Metadata - returns full Metadata object with title, description, openGraph (title, description, url, type: 'article', images with dynamic URL), twitter (card: 'summary_large_image'), alternates (canonical)
</action>
  <verify>
cat src/lib/seo/metadata.ts | grep "createTitle\|createDescription\|buildMatchMetadata"
cat src/lib/seo/metadata.ts | grep "upcoming\|live\|finished" | head -5</verify>
  <done>
Metadata builders produce correct title/description for all match states</done>
</task>

<task type="auto">
  <name>Create JSON-LD schema builders (SportsEvent, Article, Graph)</name>
  <files>src/lib/seo/schema/sports-event.ts, src/lib/seo/schema/article.ts, src/lib/seo/schema/graph.ts</files>
  <action>
Create src/lib/seo/schema/sports-event.ts:
- buildSportsEventSchema(match: MatchSeoData): WithContext<SportsEvent>
- Map status to schema.org EventStatus (EventScheduled for upcoming/live, EventCompleted for finished)
- Include homeTeam/awayTeam as SportsOrganization with @id references
- Include venue as Place with name
- Use @id linking pattern from research

Create src/lib/seo/schema/article.ts:
- buildArticleSchema(match: MatchSeoData): WithContext<Article>
- headline from match title
- datePublished = match.startDate (or article creation for upcoming)
- dateModified = updatedAt
- author = BettingSoccer organization
- about = SportsEvent @id reference

Create src/lib/seo/schema/graph.ts:
- buildMatchGraphSchema(match: MatchSeoData): WithContext<unknown>
- Combine SportsOrganization (homeTeam), SportsOrganization (awayTeam), SportsEvent, Article into @graph array
- sanitizeJsonLd(jsonLd: object): string - escape < as \u003c
</action>
  <verify>
cat src/lib/seo/schema/sports-event.ts | grep "buildSportsEventSchema\|EventScheduled\|EventCompleted"
cat src/lib/seo/schema/article.ts | grep "buildArticleSchema\|NewsArticle"
cat src/lib/seo/schema/graph.ts | grep "buildMatchGraphSchema\|@graph\|sanitizeJsonLd"</verify>
  <done>
Schema builders produce valid JSON-LD @graph with all required entities</done>
</task>

<task type="auto">
  <name>Create OG image template configuration</name>
  <files>src/lib/seo/og/templates.ts</files>
  <action>
Create src/lib/seo/og/templates.ts:
- OG_TEMPLATES object with 3 templates (upcoming, live, finished):
  - upcoming: green gradient (#1f4037 -> #99b993), "Predictions Open" badge
  - live: purple gradient (#2d1f3d -> #1a1a2e), red live indicator, time remaining
  - finished: blue gradient (#1a1a2e -> #16213e), large score, winner indicator
- getTemplateForMatch(match: MatchSeoData): OGTemplateConfig - returns template based on status
- Template includes: background, textColor, accentColor, badge options
</action>
  <verify>
cat src/lib/seo/og/templates.ts | grep "upcoming\|live\|finished"
cat src/lib/seo/og/templates.ts | grep "OG_TEMPLATES\|getTemplateForMatch"</verify>
  <done>
OG templates defined for all 3 match states with appropriate styling</done>
</task>

</tasks>

<verification>
1. All files compile: npx tsc --noEmit src/lib/seo/**/*.ts
2. Exports accessible: grep -r "export" src/lib/seo/ | wc -l (should be 10+)
3. Types match schema requirements from 05-CONTEXT.md
</verification>

<success_criteria>
1. SEO utilities layer ready for plan 05-02
2. Metadata builders handle all 3 match states
3. Schema builders produce @graph with SportsEvent + Article
4. OG templates defined for upcoming/live/finished states
5. All utilities use BASE_URL for canonical URLs
</success_criteria>

<output>
After completion, create `.planning/phases/05-seo-publication/05-01-SUMMARY.md`
</output>
