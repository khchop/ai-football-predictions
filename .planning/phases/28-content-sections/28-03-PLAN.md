---
phase: 28-content-sections
plan: 03
type: execute
wave: 2
depends_on: ["28-01", "28-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Pre-match narrative renders for upcoming matches with 'Match Preview' heading"
    - "Post-match narrative renders for finished matches with 'Match Report' heading"
    - "Predictions table is sortable by clicking column headers"
    - "Finished matches show actual result header and color-coded points"
---

<objective>
Visual verification of content sections across all match states (upcoming, live, finished).

Purpose: Confirm narrative and predictions table components render correctly in the browser before marking phase complete.

Output: Human verification that all requirements CONT-02, CONT-03, CONT-04, CONT-05 are met.
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/28-content-sections/28-CONTEXT.md
@.planning/phases/28-content-sections/28-01-SUMMARY.md
@.planning/phases/28-content-sections/28-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create test integration page</name>
  <files>src/app/(test)/test-content-sections/page.tsx</files>
  <action>
Create a temporary test page that renders MatchNarrative and SortablePredictionsTable with mock data for all three states.

```tsx
import { MatchDataProvider } from '@/components/match/match-data-provider';
import { MatchNarrative } from '@/components/match/match-narrative';
import { SortablePredictionsTable } from '@/components/match/sortable-predictions-table';
import { PredictionsSummary } from '@/components/match/predictions-summary';

// Mock data for testing
const mockMatch = {
  id: 'test-match-id',
  homeTeam: 'Arsenal',
  awayTeam: 'Chelsea',
  homeScore: 2,
  awayScore: 1,
  kickoffTime: new Date().toISOString(),
  status: 'finished' as const,
  // Add other required Match fields
};

const mockCompetition = {
  id: 'test-comp',
  name: 'Premier League',
  // Add other required Competition fields
};

const mockPredictions = [
  { id: '1', modelId: 'm1', modelDisplayName: 'GPT-4o', provider: 'openai', predictedHomeScore: 2, predictedAwayScore: 1, points: 4, isExact: true, isCorrectResult: true },
  { id: '2', modelId: 'm2', modelDisplayName: 'Claude 3.5', provider: 'anthropic', predictedHomeScore: 2, predictedAwayScore: 0, points: 3, isExact: false, isCorrectResult: true },
  { id: '3', modelId: 'm3', modelDisplayName: 'Gemini Pro', provider: 'google', predictedHomeScore: 1, predictedAwayScore: 1, points: 0, isExact: false, isCorrectResult: false },
  // Add more mock predictions to simulate 35 models
];

export default function TestContentSections() {
  return (
    <div className="container mx-auto p-8 space-y-12">
      <h1 className="text-3xl font-bold">Content Sections Test</h1>

      {/* Test 1: Finished Match */}
      <section>
        <h2 className="text-xl font-semibold mb-4">1. Finished Match State</h2>
        <MatchDataProvider
          match={{...mockMatch, status: 'finished'}}
          competition={mockCompetition}
          analysis={null}
        >
          <div className="space-y-6">
            <MatchNarrative />
            <div>
              <h3 className="text-lg font-medium mb-2">AI Predictions</h3>
              <PredictionsSummary predictions={mockPredictions} />
              <SortablePredictionsTable
                predictions={mockPredictions}
                homeTeam={mockMatch.homeTeam}
                awayTeam={mockMatch.awayTeam}
                homeScore={mockMatch.homeScore}
                awayScore={mockMatch.awayScore}
                isFinished={true}
              />
            </div>
          </div>
        </MatchDataProvider>
      </section>

      {/* Test 2: Upcoming Match */}
      <section>
        <h2 className="text-xl font-semibold mb-4">2. Upcoming Match State</h2>
        <MatchDataProvider
          match={{...mockMatch, status: 'scheduled', homeScore: null, awayScore: null}}
          competition={mockCompetition}
          analysis={null}
        >
          <div className="space-y-6">
            <MatchNarrative />
            <div>
              <h3 className="text-lg font-medium mb-2">AI Predictions</h3>
              <SortablePredictionsTable
                predictions={mockPredictions.map(p => ({...p, points: null, isExact: false, isCorrectResult: false}))}
                homeTeam={mockMatch.homeTeam}
                awayTeam={mockMatch.awayTeam}
                isFinished={false}
              />
            </div>
          </div>
        </MatchDataProvider>
      </section>

      {/* Test 3: Live Match */}
      <section>
        <h2 className="text-xl font-semibold mb-4">3. Live Match State</h2>
        <MatchDataProvider
          match={{...mockMatch, status: 'live', homeScore: 1, awayScore: 0}}
          competition={mockCompetition}
          analysis={null}
        >
          <div className="space-y-6">
            <MatchNarrative />
            <div>
              <h3 className="text-lg font-medium mb-2">AI Predictions</h3>
              <SortablePredictionsTable
                predictions={mockPredictions.map(p => ({...p, points: null, isExact: false, isCorrectResult: false}))}
                homeTeam={mockMatch.homeTeam}
                awayTeam={mockMatch.awayTeam}
                isFinished={false}
              />
            </div>
          </div>
        </MatchDataProvider>
      </section>
    </div>
  );
}
```

Adapt mock data types to match actual Match and Competition interfaces from the codebase.
  </action>
  <verify>
    - File exists: `ls src/app/(test)/test-content-sections/page.tsx`
    - TypeScript compiles: `npx tsc --noEmit`
    - Page loads: Navigate to http://localhost:3000/test-content-sections
  </verify>
  <done>
    Test page created that renders all components with mock data for visual verification.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Content sections: MatchNarrative component and SortablePredictionsTable with PredictionsSummary.

    Components created:
    1. MatchNarrative - displays pre/post match narrative based on matchState
    2. SortablePredictionsTable - sortable table with color-coded points
    3. PredictionsSummary - shows exact/winner/miss counts
  </what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Navigate to http://localhost:3000/test-content-sections

    **Verify Finished Match State:**
    - [ ] Heading shows "Match Report" (not "Match Preview")
    - [ ] Narrative content displays (or placeholder if none)
    - [ ] Predictions table shows "Actual Result: Arsenal 2 - 1 Chelsea" header
    - [ ] Clicking "Model" column header sorts alphabetically
    - [ ] Clicking "Points" column header sorts by points
    - [ ] Points badges are color-coded: 4+ green, 3 yellow, 2 orange, 0 gray
    - [ ] Exact score row has green background
    - [ ] Correct result row has subtle yellow background
    - [ ] Icons visible: Trophy (green), Target (yellow), X (gray)
    - [ ] Summary shows "X exact scores, Y got winner, Z missed"

    **Verify Upcoming Match State:**
    - [ ] Heading shows "Match Preview" (not "Match Report")
    - [ ] No "Actual Result" header in table
    - [ ] No Points column in table
    - [ ] No Result icons column
    - [ ] Table sorted alphabetically by model name

    **Verify Live Match State:**
    - [ ] Heading shows "Match Preview" (same as upcoming)
    - [ ] Predictions table same as upcoming (no points)

    **Verify Mobile (resize browser):**
    - [ ] Table scrolls horizontally
    - [ ] All 35 rows visible via scroll
    - [ ] No content cut off

  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe issues found</resume-signal>
</task>

<task type="auto">
  <name>Task 3: Remove test page after verification</name>
  <files>src/app/(test)/test-content-sections/page.tsx</files>
  <action>
After verification passes, delete the test page:

```bash
rm -rf src/app/(test)/test-content-sections
```

If the (test) directory is now empty, remove it too.
  </action>
  <verify>
    - Test page removed: `! ls src/app/(test)/test-content-sections/page.tsx 2>/dev/null`
  </verify>
  <done>
    Test page cleaned up after successful verification.
  </done>
</task>

</tasks>

<verification>
1. All visual checks pass for finished/upcoming/live states
2. Sorting works correctly
3. Color-coded points display correctly
4. Mobile layout scrolls properly
5. Test page removed after verification
</verification>

<success_criteria>
Human approves visual verification:
- CONT-02: Pre-match narrative renders for upcoming matches (heading: "Match Preview")
- CONT-03: Post-match narrative renders for finished matches (heading: "Match Report")
- CONT-04: Predictions table shows all 35 models in sortable format
- CONT-05: Finished match predictions show actual result and points earned
</success_criteria>

<output>
After completion, create `.planning/phases/28-content-sections/28-03-SUMMARY.md`
</output>
