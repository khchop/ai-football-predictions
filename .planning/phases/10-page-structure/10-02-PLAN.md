---
phase: 10-page-structure
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/seo/metadata.ts
  - src/lib/seo/abbreviations.ts
  - src/app/leagues/[slug]/page.tsx
autonomous: true

must_haves:
  truths:
    - "Match page titles are under 60 characters"
    - "League page titles are under 60 characters"
    - "Long team names are abbreviated consistently"
    - "Titles still contain team names and key content"
    - "Brand suffix (kroam.xyz) appears when space allows"
  artifacts:
    - path: "src/lib/seo/abbreviations.ts"
      provides: "Team and competition name abbreviation utilities"
      exports: ["abbreviateTeam", "abbreviateCompetition"]
      min_lines: 30
    - path: "src/lib/seo/metadata.ts"
      provides: "Optimized title generation"
      contains: "abbreviateTeam"
    - path: "src/app/leagues/[slug]/page.tsx"
      provides: "League page with optimized title"
      contains: "abbreviateCompetition"
  key_links:
    - from: "src/lib/seo/metadata.ts"
      to: "src/lib/seo/abbreviations.ts"
      via: "import abbreviateTeam"
      pattern: "import.*abbreviateTeam.*from"
    - from: "src/app/leagues/[slug]/page.tsx"
      to: "src/lib/seo/abbreviations.ts"
      via: "import abbreviateCompetition"
      pattern: "import.*abbreviateCompetition.*from"
---

<objective>
Optimize title templates for match and league pages to stay under 60 characters while preserving SEO value.

Purpose: SEO-T06 and SEO-T07 require title tags under 60 characters to prevent truncation in search results. Current templates exceed this limit for 125+ match pages and many league pages.

Output: Centralized abbreviation utilities and optimized title generation functions.
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-page-structure/10-RESEARCH.md

# Current implementation to modify
@src/lib/seo/metadata.ts
@src/lib/seo/constants.ts
@src/app/leagues/[slug]/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create abbreviation utilities</name>
  <files>src/lib/seo/abbreviations.ts</files>
  <action>
Create a new file with centralized abbreviation utilities:

```typescript
// Team abbreviations for common long names (15+ chars)
const TEAM_ABBREVIATIONS: Record<string, string> = {
  'Manchester United': 'Man Utd',
  'Manchester City': 'Man City',
  'Tottenham Hotspur': 'Tottenham',
  'Brighton & Hove Albion': 'Brighton',
  'West Ham United': 'West Ham',
  'Wolverhampton Wanderers': 'Wolves',
  'Newcastle United': 'Newcastle',
  'Nottingham Forest': "Nott'm Forest",
  'Sheffield United': 'Sheffield Utd',
  'Crystal Palace': 'Crystal Palace', // already short enough
  'Leicester City': 'Leicester',
  'Borussia Dortmund': 'Dortmund',
  'Borussia Monchengladbach': "M'gladbach",
  'Bayern Munich': 'Bayern',
  'Bayer Leverkusen': 'Leverkusen',
  'Paris Saint-Germain': 'PSG',
  'Atletico Madrid': 'Atletico',
  'Real Sociedad': 'Sociedad',
  'Athletic Bilbao': 'Athletic',
  'Real Betis': 'Betis',
};

// Competition name optimizations
const COMPETITION_ABBREVIATIONS: Record<string, string> = {
  'UEFA Champions League': 'Champions League',
  'UEFA Europa League': 'Europa League',
  'UEFA Conference League': 'Conference League',
  'English Premier League': 'Premier League',
  'Spanish La Liga': 'La Liga',
  'German Bundesliga': 'Bundesliga',
  'Italian Serie A': 'Serie A',
  'French Ligue 1': 'Ligue 1',
};

export function abbreviateTeam(name: string): string {
  return TEAM_ABBREVIATIONS[name] || name;
}

export function abbreviateCompetition(name: string): string {
  return COMPETITION_ABBREVIATIONS[name] || name
    .replace(/^UEFA /, '')
    .replace(/^English /, '')
    .replace(/^Spanish /, '')
    .replace(/^German /, '')
    .replace(/^Italian /, '')
    .replace(/^French /, '');
}
```

The maps can be extended later as more abbreviations are needed.
  </action>
  <verify>
- File exists at src/lib/seo/abbreviations.ts
- TypeScript compiles: `npx tsc --noEmit src/lib/seo/abbreviations.ts`
- Exports both functions
  </verify>
  <done>Abbreviation utilities exist with common team and competition mappings</done>
</task>

<task type="auto">
  <name>Task 2: Optimize match title generation</name>
  <files>src/lib/seo/metadata.ts</files>
  <action>
Update the createTitle function to use abbreviations and shorter format:

1. Import abbreviateTeam from './abbreviations'
2. Modify createTitle to use shorter format:

OLD (current - exceeds 60 chars):
```typescript
if (isMatchFinished(match.status) && match.homeScore !== null && match.awayScore !== null) {
  return `${match.homeTeam} ${match.homeScore}-${match.awayScore} ${match.awayTeam} | Match Analysis & Predictions`;
}
return `${match.homeTeam} vs ${match.awayTeam} | Match Analysis & Predictions`;
```

NEW (optimized):
```typescript
const home = abbreviateTeam(match.homeTeam);
const away = abbreviateTeam(match.awayTeam);

if (isMatchFinished(match.status) && match.homeScore !== null && match.awayScore !== null) {
  // Format: "Man Utd 2-1 Liverpool | kroam.xyz" (~30-40 chars)
  return `${home} ${match.homeScore}-${match.awayScore} ${away} | kroam.xyz`;
}
// Format: "Man Utd vs Liverpool Prediction" (~30-40 chars)
return `${home} vs ${away} Prediction`;
```

Key changes:
- Remove verbose "Match Analysis & Predictions" suffix (24 chars saved)
- Use team abbreviations for long names
- Add concise brand suffix "kroam.xyz" for finished matches only
- Keep "Prediction" suffix for upcoming (clear intent, good for SEO)

Do NOT:
- Modify buildMatchMetadata (it uses createTitle, so changes propagate)
- Change description functions
- Remove the truncateWithEllipsis safety net (keep it as backup)
  </action>
  <verify>
- grep "abbreviateTeam" src/lib/seo/metadata.ts shows import and usage
- TypeScript compiles: `npx tsc --noEmit src/lib/seo/metadata.ts`
- Test title length: Create quick script or manually verify "Manchester United 2-1 Liverpool | kroam.xyz" < 60 chars
  </verify>
  <done>Match titles use abbreviated team names and concise format under 60 characters</done>
</task>

<task type="auto">
  <name>Task 3: Optimize league page title generation</name>
  <files>src/app/leagues/[slug]/page.tsx</files>
  <action>
Update generateMetadata to use abbreviated competition names:

1. Import abbreviateCompetition from '@/lib/seo/abbreviations'
2. Modify title generation:

OLD (current - can exceed 60 chars):
```typescript
const title = `${competition.name} Predictions | AI Models Compete | kroam.xyz`;
```

NEW (optimized):
```typescript
const shortName = abbreviateCompetition(competition.name);
const title = `${shortName} Predictions | kroam.xyz`;
```

Key changes:
- Remove "AI Models Compete" (17 chars saved)
- Use abbreviated competition name
- Keep brand suffix for consistency

This produces titles like:
- "Champions League Predictions | kroam.xyz" (41 chars)
- "Premier League Predictions | kroam.xyz" (40 chars)
- "Bundesliga Predictions | kroam.xyz" (35 chars)

Do NOT:
- Change the description (it can use full competition name)
- Modify the canonical URL logic
- Change OG image generation
  </action>
  <verify>
- grep "abbreviateCompetition" src/app/leagues/[slug]/page.tsx shows import and usage
- npm run build passes
- Longest competition name "UEFA Champions League" produces title under 60 chars
  </verify>
  <done>League page titles use abbreviated names and are under 60 characters</done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. Match title lengths verified:
   - "Manchester United 2-1 Liverpool | kroam.xyz" = 43 chars (under 60)
   - "Borussia Monchengladbach vs Bayern Munich Prediction" with abbreviations = "M'gladbach vs Bayern Prediction" = 31 chars
3. League title lengths verified:
   - "Champions League Predictions | kroam.xyz" = 41 chars (under 60)
4. All existing functionality preserved (descriptions, OG images, etc.)
</verification>

<success_criteria>
- SEO-T06 addressed: Match page titles under 60 characters
- SEO-T07 addressed: League page titles under 60 characters
- Centralized abbreviation utilities for maintainability
- No breaking changes to existing metadata structure
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-page-structure/10-02-SUMMARY.md`
</output>
