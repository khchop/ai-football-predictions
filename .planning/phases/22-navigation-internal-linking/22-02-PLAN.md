---
phase: 22-navigation-internal-linking
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/navigation/breadcrumbs.tsx
  - src/lib/navigation/breadcrumb-utils.ts
autonomous: true

must_haves:
  truths:
    - "User sees visual breadcrumb trail showing navigation hierarchy"
    - "Last breadcrumb item has aria-current='page'"
    - "Separator elements are aria-hidden"
  artifacts:
    - path: "src/components/navigation/breadcrumbs.tsx"
      provides: "Visual breadcrumb component"
      exports: ["Breadcrumbs", "BreadcrumbsWithSchema"]
    - path: "src/lib/navigation/breadcrumb-utils.ts"
      provides: "Breadcrumb item builders for each page type"
      exports: ["buildMatchBreadcrumbs", "buildLeagueBreadcrumbs", "buildBlogBreadcrumbs", "buildModelBreadcrumbs", "buildLeaderboardBreadcrumbs"]
  key_links:
    - from: "src/components/navigation/breadcrumbs.tsx"
      to: "src/components/BreadcrumbSchema.tsx"
      via: "BreadcrumbsWithSchema combines visual + schema"
      pattern: "BreadcrumbSchema"
---

<objective>
Create visual breadcrumb component and utility functions for building breadcrumb trails across all page types.

Purpose: Breadcrumbs help users orient within site hierarchy (NAVL-02). The BreadcrumbSchema component already exists for SEO - this plan adds the visual UI component and combines them. Utility functions ensure consistent breadcrumb generation across pages.

Output: Reusable Breadcrumbs component and builder utilities for each page type.
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-navigation-internal-linking/22-RESEARCH.md

# Existing schema component to integrate with
@src/components/BreadcrumbSchema.tsx
@src/lib/seo/constants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create visual Breadcrumbs component</name>
  <files>src/components/navigation/breadcrumbs.tsx</files>
  <action>
Create visual breadcrumb component following accessibility patterns from research:

1. Create src/components/navigation/breadcrumbs.tsx (Server Component - no 'use client')
2. Use proper HTML structure: nav[aria-label="Breadcrumbs"] > ol > li > Link/span
3. Import ChevronRight from lucide-react for separator
4. Separator element must have aria-hidden="true"
5. Last item uses span with aria-current="page" (not a link)
6. Truncate long names with max-w-[200px] on last item, max-w-[150px] on others

Interface:
```typescript
interface BreadcrumbItem {
  name: string;
  href: string;
}

interface BreadcrumbsProps {
  items: BreadcrumbItem[];
}
```

Styling:
- Container: text-sm text-muted-foreground mb-4
- Links: hover:text-foreground transition-colors
- Active item: font-medium text-foreground
- Truncation: truncate class on links/spans

7. Export BreadcrumbsWithSchema that combines visual + schema:
```typescript
import { BreadcrumbSchema } from '@/components/BreadcrumbSchema';
import { BASE_URL } from '@/lib/seo/constants';

export function BreadcrumbsWithSchema({ items }: BreadcrumbsProps) {
  // Convert to absolute URLs for schema
  const schemaItems = items.map((item) => ({
    name: item.name,
    url: item.href.startsWith('http') ? item.href : `${BASE_URL}${item.href}`,
  }));

  return (
    <>
      <BreadcrumbSchema breadcrumbs={schemaItems} />
      <Breadcrumbs items={items} />
    </>
  );
}
```
  </action>
  <verify>
1. Component compiles: `npx tsc --noEmit`
2. Has aria-label: `grep 'aria-label="Breadcrumbs"' src/components/navigation/breadcrumbs.tsx`
3. Has aria-current: `grep 'aria-current="page"' src/components/navigation/breadcrumbs.tsx`
4. Has aria-hidden on separator: `grep 'aria-hidden="true"' src/components/navigation/breadcrumbs.tsx`
5. Exports both: `grep -E "export function (Breadcrumbs|BreadcrumbsWithSchema)" src/components/navigation/breadcrumbs.tsx`
  </verify>
  <done>
Breadcrumbs and BreadcrumbsWithSchema components exist with proper accessibility attributes and schema integration.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create breadcrumb builder utilities</name>
  <files>src/lib/navigation/breadcrumb-utils.ts</files>
  <action>
Create utility functions for building breadcrumb arrays for each page type:

1. Create src/lib/navigation/breadcrumb-utils.ts
2. Define BreadcrumbItem type (name, href)
3. Create builder functions that return BreadcrumbItem[]:

```typescript
// Match page: Home > League > Match
export function buildMatchBreadcrumbs(
  competitionName: string,
  competitionSlug: string,
  matchTitle: string,
  matchSlug: string
): BreadcrumbItem[]

// League page: Home > Leagues > League
export function buildLeagueBreadcrumbs(
  competitionName: string,
  competitionSlug: string
): BreadcrumbItem[]

// Blog page: Home > Blog > Post
export function buildBlogBreadcrumbs(
  postTitle: string,
  postSlug: string
): BreadcrumbItem[]

// Model page: Home > Models > Model
export function buildModelBreadcrumbs(
  modelName: string,
  modelId: string
): BreadcrumbItem[]

// Leaderboard page: Home > Leaderboard
export function buildLeaderboardBreadcrumbs(): BreadcrumbItem[]
```

Each function should:
- Always start with { name: 'Home', href: '/' }
- Use correct intermediate pages (Leagues, Blog, Models)
- Final item href should be empty string '' (current page)

Example for match:
```typescript
export function buildMatchBreadcrumbs(
  competitionName: string,
  competitionSlug: string,
  matchTitle: string,
  _matchSlug: string // Not used in href since it's current page
): BreadcrumbItem[] {
  return [
    { name: 'Home', href: '/' },
    { name: competitionName, href: `/leagues/${competitionSlug}` },
    { name: matchTitle, href: '' }, // Current page
  ];
}
```
  </action>
  <verify>
1. File compiles: `npx tsc --noEmit`
2. All builders exported: `grep -c "export function build" src/lib/navigation/breadcrumb-utils.ts` should return 5
3. Each builder starts with Home: `grep -c "name: 'Home'" src/lib/navigation/breadcrumb-utils.ts` should return 5
  </verify>
  <done>
Five breadcrumb builder functions exist for match, league, blog, model, and leaderboard pages.
  </done>
</task>

</tasks>

<verification>
1. Breadcrumbs component has proper nav > ol > li structure
2. Accessibility attributes are correct (aria-label, aria-current, aria-hidden)
3. BreadcrumbsWithSchema combines visual display with JSON-LD schema
4. All five builder utilities return correct breadcrumb arrays
5. No TypeScript errors
</verification>

<success_criteria>
- Visual Breadcrumbs component ready for deployment
- BreadcrumbsWithSchema combines visual + schema in one call
- Builder utilities simplify consistent breadcrumb generation
- Proper accessibility for screen readers
</success_criteria>

<output>
After completion, create `.planning/phases/22-navigation-internal-linking/22-02-SUMMARY.md`
</output>
