---
phase: 20-league-page-rebuild
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/league/generate-league-faqs.ts
  - src/components/league/league-faq.tsx
autonomous: true

must_haves:
  truths:
    - "FAQ section renders 5 questions with native details/summary accordion"
    - "TL;DR question appears first in FAQ list"
    - "FAQ answers include dynamic stats (match count, accuracy, best model)"
    - "FAQPage JSON-LD schema is injected alongside visible FAQ content"
  artifacts:
    - path: "src/lib/league/generate-league-faqs.ts"
      provides: "Dynamic FAQ generation from competition data"
      exports: ["generateLeagueFAQs"]
    - path: "src/components/league/league-faq.tsx"
      provides: "FAQ section with native accordion and schema"
      exports: ["LeagueFAQ"]
  key_links:
    - from: "src/components/league/league-faq.tsx"
      to: "FaqSchema"
      via: "component import"
      pattern: "import.*FaqSchema.*from"
    - from: "src/lib/league/generate-league-faqs.ts"
      to: "CompetitionConfig"
      via: "type import"
      pattern: "import.*CompetitionConfig"
---

<objective>
Create dynamic FAQ generation and LeagueFAQ component for GEO optimization.

Purpose: Enable AI search engines to cite league page content via FAQPage schema (LEAG-03)
Output: generateLeagueFAQs utility, LeagueFAQ component matching blog-faq.tsx pattern
</objective>

<execution_context>
@/Users/pieterbos/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pieterbos/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/20-league-page-rebuild/20-RESEARCH.md

@src/components/blog/blog-faq.tsx (pattern to follow)
@src/components/FaqSchema.tsx (schema injection)
@src/lib/seo/schemas.ts (FAQItem type)
@src/lib/football/competitions.ts (CompetitionConfig type)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FAQ generation utility</name>
  <files>src/lib/league/generate-league-faqs.ts</files>
  <action>
    Create new file src/lib/league/generate-league-faqs.ts:

    1. Create directory if needed: src/lib/league/

    2. Define input interface:
       ```typescript
       interface LeagueFAQData {
         competition: {
           id: string;
           name: string;
         };
         stats: {
           finishedMatches: number;
           avgGoalsPerMatch: number;
         };
         topModel?: {
           model: { name: string };
           accuracy: number;
         };
       }
       ```

    3. Export function generateLeagueFAQs(data: LeagueFAQData): FAQItem[]:
       - Import FAQItem type from '@/lib/seo/schemas'
       - Generate 5 FAQs (user decision from Phase 19: 5 FAQ max)
       - TL;DR question FIRST (user decision from Phase 19)

    4. FAQ content (dynamic with stats):
       Q1 (TL;DR): "What are the AI predictions for {name}?"
       A1: "Our platform uses 35 AI models to predict exact scores for {name} matches. The models analyze team form, head-to-head records, standings, and lineups to generate predictions approximately 30 minutes before kickoff."

       Q2: "How accurate are AI predictions for {name}?"
       A2: "Across {finishedMatches} {name} matches, our AI models achieve varying accuracy levels. {If topModel: The best performing model is {topModel.name} with {accuracy}% tendency accuracy.}"

       Q3: "How many {name} matches have been predicted?"
       A3: "We have tracked and predicted {finishedMatches} {name} matches with AI analysis and exact score predictions from 35 different models."

       Q4: "When are {name} predictions available?"
       A4: "Predictions for {name} matches are generated approximately 30 minutes before kickoff, once official team lineups are announced. This ensures predictions incorporate the most relevant team information."

       Q5: "What scoring system is used for {name} predictions?"
       A5: "We use the Kicktipp quota scoring system where correct predictions earn 2-6 points based on rarity, with an additional 3-point bonus for exact score matches (maximum 10 points per prediction)."

    5. Truncate answers to 300 chars max (user decision from Phase 19)
       - If answer > 300 chars, truncate at last complete sentence before 300 chars
       - Helper: truncateToSentence(text: string, maxLength: number): string
  </action>
  <verify>
    Run `npx tsc --noEmit src/lib/league/generate-league-faqs.ts` - no type errors.
    File exists with exported generateLeagueFAQs function.
  </verify>
  <done>
    generateLeagueFAQs() returns 5 FAQItem[] with dynamic content.
    TL;DR question is first.
    All answers truncated to <= 300 chars.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create LeagueFAQ component</name>
  <files>src/components/league/league-faq.tsx</files>
  <action>
    Create new file src/components/league/league-faq.tsx following blog-faq.tsx pattern exactly:

    1. Create directory if needed: src/components/league/

    2. Copy structure from blog-faq.tsx:
       - Same interface: { faqs: FAQItem[] }
       - Same null guard: if (!faqs || faqs.length === 0) return null
       - Same section wrapper: mt-16 pt-8 border-t border-border/50
       - Same h2: "Frequently Asked Questions"
       - Same native details/summary accordion with chevron icon
       - Same FaqSchema injection at bottom

    3. Key styling (match blog-faq.tsx exactly):
       - details: group border border-border/50 rounded-lg
       - summary: cursor-pointer font-medium text-base md:text-lg py-4 px-4 hover:bg-muted/30 transition-colors list-none flex items-center justify-between
       - chevron: w-5 h-5 text-muted-foreground transition-transform group-open:rotate-180
       - answer div: px-4 pb-4 pt-2 text-muted-foreground leading-relaxed text-sm md:text-base border-t border-border/30

    4. Import FaqSchema from '@/components/FaqSchema'
    5. Import FAQItem from '@/lib/seo/schemas'

    This is intentionally near-identical to blog-faq.tsx for visual consistency.
  </action>
  <verify>
    Run `npx tsc --noEmit src/components/league/league-faq.tsx` - no type errors.
    Compare visually with blog-faq.tsx - should be structurally identical.
  </verify>
  <done>
    LeagueFAQ component renders native details/summary accordion.
    FaqSchema component injects FAQPage JSON-LD.
    Styling matches blog-faq.tsx exactly for consistency.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npx tsc --noEmit src/lib/league/generate-league-faqs.ts src/components/league/league-faq.tsx`
2. Directory structure exists:
   - src/lib/league/generate-league-faqs.ts
   - src/components/league/league-faq.tsx
3. Exports are correct:
   - generateLeagueFAQs function exported
   - LeagueFAQ component exported
</verification>

<success_criteria>
- LEAG-03 (FAQ section): Component ready for integration
- Dynamic FAQs generated with competition stats
- TL;DR question first per Phase 19 decision
- 300 char answer truncation per Phase 19 decision
- 5 FAQ max per Phase 19 decision
- Native details/summary (no JavaScript accordion)
- FAQPage schema injection via existing FaqSchema component
</success_criteria>

<output>
After completion, create `.planning/phases/20-league-page-rebuild/20-02-SUMMARY.md`
</output>
